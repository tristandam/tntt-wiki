"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[45385],{26285:function(e,n,t){t.r(n),t.d(n,{assets:function(){return d},contentTitle:function(){return l},default:function(){return c},frontMatter:function(){return r},metadata:function(){return p},toc:function(){return u}});var a=t(83117),o=t(80102),s=(t(67294),t(3905)),i=["components"],r={description:"Learn about key concepts to consider for Node maintenance. These include configuring storage, plugins, spammers, and how to work with snapshots.",image:"/img/logo/HornetLogo.png",keywords:["IOTA Node","Hornet Node","storage","configuration","spammer","snapshots","reference"]},l=void 0,p={unversionedId:"post_installation/managing_a_node",id:"post_installation/managing_a_node",title:"managing_a_node",description:"Learn about key concepts to consider for Node maintenance. These include configuring storage, plugins, spammers, and how to work with snapshots.",source:"@site/external/hornet/documentation/docs/post_installation/managing_a_node.md",sourceDirName:"post_installation",slug:"/post_installation/managing_a_node",permalink:"/hornet/post_installation/managing_a_node",editUrl:"https://github.com/gohornet/hornet/edit/mainnet/external/hornet/documentation/docs/post_installation/managing_a_node.md",tags:[],version:"current",frontMatter:{description:"Learn about key concepts to consider for Node maintenance. These include configuring storage, plugins, spammers, and how to work with snapshots.",image:"/img/logo/HornetLogo.png",keywords:["IOTA Node","Hornet Node","storage","configuration","spammer","snapshots","reference"]},sidebar:"mySidebar",previous:{title:"post_installation",permalink:"/hornet/post_installation/"},next:{title:"configuration",permalink:"/hornet/post_installation/configuration"}},d={},u=[{value:"Storage",id:"storage",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Spammer",id:"spammer",level:2},{value:"Snapshots",id:"snapshots",level:2},{value:"Snapshot Pruning",id:"snapshot-pruning",level:3},{value:"Delta snapshots",id:"delta-snapshots",level:4},{value:"Full snapshots",id:"full-snapshots",level:4},{value:"How to Work With Snapshots",id:"how-to-work-with-snapshots",level:3}],h={toc:u};function c(e){var n=e.components,t=(0,o.Z)(e,i);return(0,s.kt)("wrapper",(0,a.Z)({},h,t,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"managing-a-node"},"Managing a Node"),(0,s.kt)("p",null,"In this section, you can find an overview of the key concepts that you should consider during your node's maintenance cycle."),(0,s.kt)("h2",{id:"storage"},"Storage"),(0,s.kt)("p",null,"Hornet uses an embedded database engine that stores its data in a directory in a file system. You can manage the location using the ",(0,s.kt)("inlineCode",{parentName:"p"},"config.json")," file, under the ",(0,s.kt)("inlineCode",{parentName:"p"},"db")," section, with the ",(0,s.kt)("inlineCode",{parentName:"p"},"path")," key:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json{3}"},'"db": {\n    "engine": "rocksdb",\n    "path": "mainnetdb",\n    "autoRevalidation": false\n  }\n')),(0,s.kt)("p",null,"By convention, you should name that directory after the network type: ",(0,s.kt)("inlineCode",{parentName:"p"},"mainnet")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"testnet"),"."),(0,s.kt)("p",null,"Another important directory is the ",(0,s.kt)("inlineCode",{parentName:"p"},"snapshots")," directory. You can control the ",(0,s.kt)("inlineCode",{parentName:"p"},"snapshots")," in the ",(0,s.kt)("inlineCode",{parentName:"p"},"snapshots")," section of the ",(0,s.kt)("inlineCode",{parentName:"p"},"config.json")," file, specifically the ",(0,s.kt)("inlineCode",{parentName:"p"},"fullPath")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"deltaPath")," keys:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'"snapshots": {\n    "interval": 50,\n    "fullPath": "snapshots/mainnet/full_snapshot.bin",\n    "deltaPath": "snapshots/mainnet/delta_snapshot.bin",\n    "deltaSizeThresholdPercentage": 50.0,\n    "downloadURLs": [\n      {\n        "full": "https://chrysalis-dbfiles.iota.org/snapshots/hornet/latest-full_snapshot.bin",\n        "delta": "https://chrysalis-dbfiles.iota.org/snapshots/hornet/latest-delta_snapshot.bin"\n      },\n      {\n        "full": "https://cdn.tanglebay.com/snapshots/mainnet/full_snapshot.bin",\n        "delta": "https://cdn.tanglebay.com/snapshots/mainnet/delta_snapshot.bin"\n      }\n    ]\n')),(0,s.kt)("p",null,"You should apply the same convention you use for the database engine to name the directories after the network type: ",(0,s.kt)("inlineCode",{parentName:"p"},"mainnet")," or ",(0,s.kt)("inlineCode",{parentName:"p"},"testnet"),"."),(0,s.kt)("p",null,"Here is the full overview of all files and directories that are leveraged by the Hornet:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-plaintext"},".\n\u251c\u2500\u2500 config.json\n\u251c\u2500\u2500 hornet              <EXECUTABLE>\n\u251c\u2500\u2500 p2pstore\n\u2502\xa0\xa0 \u251c\u2500\u2500 [...files]\n\u251c\u2500\u2500 snapshots           <SNAPSHOT DIR>\n\u2502\xa0\xa0 \u2514\u2500\u2500 testnet\n\u2502\xa0\xa0     \u251c\u2500\u2500 delta_snapshot.bin\n\u2502\xa0\xa0     \u2514\u2500\u2500 full_snapshot.bin\n\u2514\u2500\u2500 testnetdb           <DB DIR>\n    \u251c\u2500\u2500 [...db files]\n")),(0,s.kt)("h2",{id:"plugins"},"Plugins"),(0,s.kt)("p",null,"Hornet can be extended by plugins. You can control plugins using the ",(0,s.kt)("inlineCode",{parentName:"p"},"node")," section in the ",(0,s.kt)("inlineCode",{parentName:"p"},"config.json")," file, specifically ",(0,s.kt)("inlineCode",{parentName:"p"},"disablePlugins")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"enablePlugins")," keys:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'"node": {\n    "alias": "Mainnet",\n    "profile": "auto",\n    "disablePlugins": [],\n    "enablePlugins": []\n  },\n')),(0,s.kt)("p",null,"You can also control plugins using the ",(0,s.kt)("a",{parentName:"p",href:"https://wiki.iota.org/hornet/post_installation#dashboard"},"Dashboard/web interface"),"."),(0,s.kt)("h2",{id:"spammer"},"Spammer"),(0,s.kt)("p",null,"Hornet integrates a lightweight spamming plugin that spams the network with messages. The IOTA network is based on a Directed Acyclic Graph. So, new incoming messages are connected to previous messages (tips). It is healthy for the network to maintain some level of message rate."),(0,s.kt)("p",null,"The Spammer plugin allows your node to send several data messages at regular intervals. You can set the interval with the ",(0,s.kt)("inlineCode",{parentName:"p"},"mpsRateLimit")," key, which is the number of messages per second (TPS) that the plugin should try to send."),(0,s.kt)("p",null,"For example, value ",(0,s.kt)("inlineCode",{parentName:"p"},'"mpsRateLimit": 0.1')," would mean to send 1 message every 10 seconds."),(0,s.kt)("p",null,"You can change the default configuration by enabling this plugin since it is usually disabled."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},' "spammer": {\n    "message": "IOTA - A new dawn",\n    "index": "HORNET Spammer",\n    "indexSemiLazy": "HORNET Spammer Semi-Lazy",\n    "cpuMaxUsage": 0.8,\n    "mpsRateLimit": 0.0,\n    "workers": 0,\n    "autostart": false\n  }\n')),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"This plugin can also be leveraged during a spamming event during which the community tests the throughput of the network."))),(0,s.kt)("h2",{id:"snapshots"},"Snapshots"),(0,s.kt)("p",null,"Your node's ledger accumulates many messages, which uses a significant disk capacity over time. This section discusses configuring local snapshots to prune old transactions from your node's database and create backup snapshot files."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},' "snapshots": {\n    "interval": 50,\n    "fullPath": "snapshots/mainnet/full_snapshot.bin",\n    "deltaPath": "snapshots/mainnet/delta_snapshot.bin",\n    "deltaSizeThresholdPercentage": 50.0,\n    "downloadURLs": [\n      {\n        "full": "https://chrysalis-dbfiles.iota.org/snapshots/hornet/latest-full_snapshot.bin",\n        "delta": "https://chrysalis-dbfiles.iota.org/snapshots/hornet/latest-delta_snapshot.bin"\n      },\n      {\n        "full": "https://cdn.tanglebay.com/snapshots/mainnet/full_snapshot.bin",\n        "delta": "https://cdn.tanglebay.com/snapshots/mainnet/delta_snapshot.bin"\n      }\n    ]\n  },\n  "pruning": {\n    "milestones": {\n      "enabled": false,\n      "maxMilestonesToKeep": 60480\n    },\n    "size": {\n      "enabled": true,\n      "targetSize": "30GB",\n      "thresholdPercentage": 10.0,\n      "cooldownTime": "5m"\n    },\n    "pruneReceipts": false\n  },\n')),(0,s.kt)("h3",{id:"snapshot-pruning"},"Snapshot Pruning"),(0,s.kt)("p",null,"During a snapshot, Hornet may delete messages from the ledger if they were confirmed by an old milestone. In other words, the term ",(0,s.kt)("em",{parentName:"p"},"pruning")," means the deletion of the old history from the node database."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"If you want to enable pruning, you should set the ",(0,s.kt)("inlineCode",{parentName:"li"},"pruning.milestones.enabled")," or ",(0,s.kt)("inlineCode",{parentName:"li"},"pruning.size.enabled")," keys to ",(0,s.kt)("em",{parentName:"li"},"enabled"),"."),(0,s.kt)("li",{parentName:"ul"},"The ",(0,s.kt)("inlineCode",{parentName:"li"},"pruning.milestones.maxMilestonesToKeep")," defines how far back from the current confirmed milestone should be pruned."),(0,s.kt)("li",{parentName:"ul"},"The ",(0,s.kt)("inlineCode",{parentName:"li"},"pruning.size.targetSize")," defines the maximum database size. Old data will be pruned.")),(0,s.kt)("p",null,"There are two types of snapshots:"),(0,s.kt)("h4",{id:"delta-snapshots"},"Delta snapshots"),(0,s.kt)("p",null,"A delta snapshot points to a specific full snapshot, meaning a delta snapshot consists of the changes since the last full snapshot."),(0,s.kt)("h4",{id:"full-snapshots"},"Full snapshots"),(0,s.kt)("p",null,"The full snapshot includes the whole ledger state to a specific milestone and a solid entry point."),(0,s.kt)("h3",{id:"how-to-work-with-snapshots"},"How to Work With Snapshots"),(0,s.kt)("p",null,"If you are running a Hornet node for the first time, you will need to start it with a full snapshot. Hornet automatically downloads this from trusted sources."),(0,s.kt)("p",null,"Additionally, you can start Hornet with a specific delta snapshot using the ",(0,s.kt)("inlineCode",{parentName:"p"},"Hornet")," tools:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"hornet tool\n")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"snap-gen")," Generates an initial snapshot for a private network."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"snap-merge")," Merges a full and delta snapshot into an updated full snapshot."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"snap-info")," Outputs information about a snapshot file.")))}c.isMDXComponent=!0},3905:function(e,n,t){t.d(n,{Zo:function(){return d},kt:function(){return c}});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),h=p(t),c=o,m=h["".concat(l,".").concat(c)]||h[c]||u[c]||s;return t?a.createElement(m,i(i({ref:n},d),{},{components:t})):a.createElement(m,i({ref:n},d))}));function c(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=t.length,i=new Array(s);i[0]=h;var r={};for(var l in n)hasOwnProperty.call(n,l)&&(r[l]=n[l]);r.originalType=e,r.mdxType="string"==typeof e?e:o,i[1]=r;for(var p=2;p<s;p++)i[p]=t[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}h.displayName="MDXCreateElement"}}]);