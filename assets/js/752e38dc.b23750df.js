"use strict";(self.webpackChunkiota_wiki=self.webpackChunkiota_wiki||[]).push([[7493],{62495:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return f},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return c}});var n=a(83117),r=a(80102),i=(a(67294),a(3905)),s=["components"],l={title:"Issuance",sidebar_label:"Issuance"},o=void 0,d={unversionedId:"specs/didcomm/protocols/issuance",id:"specs/didcomm/protocols/issuance",title:"Issuance",description:"The IOTA DIDComm Specification is in the RFC phase and may undergo changes. Suggestions are welcome at GitHub #464.",source:"@site/external/identity.rs/documentation/docs/specs/didcomm/protocols/issuance.md",sourceDirName:"specs/didcomm/protocols",slug:"/specs/didcomm/protocols/issuance",permalink:"/identity.rs/specs/didcomm/protocols/issuance",editUrl:"https://github.com/iotaledger/identity.rs/edit/dev/external/identity.rs/documentation/docs/specs/didcomm/protocols/issuance.md",tags:[],version:"current",frontMatter:{title:"Issuance",sidebar_label:"Issuance"},sidebar:"docs",previous:{title:"Presentation",permalink:"/identity.rs/specs/didcomm/protocols/presentation"},next:{title:"Signing",permalink:"/identity.rs/specs/didcomm/protocols/signing"}},p={},c=[{value:"Overview",id:"overview",level:2},{value:"Relationships",id:"relationships",level:3},{value:"Example Use-Cases",id:"example-use-cases",level:3},{value:"Roles",id:"roles",level:3},{value:"Interaction",id:"interaction",level:3},{value:"Messages",id:"messages",level:2},{value:"1. issuance-request",id:"issuance-request",level:3},{value:"Structure",id:"structure",level:4},{value:"Examples",id:"examples",level:4},{value:"2. issuance-offer",id:"issuance-offer",level:3},{value:"Structure",id:"structure-1",level:4},{value:"Examples",id:"examples-1",level:4},{value:"3. issuance-response",id:"issuance-response",level:3},{value:"Structure",id:"structure-2",level:4},{value:"Examples",id:"examples-2",level:4},{value:"4. issuance",id:"issuance-message",level:3},{value:"Structure",id:"structure-3",level:4},{value:"Examples",id:"examples-3",level:4},{value:"5. issuance-acknowledgment",id:"issuance-acknowledgment",level:3},{value:"Structure",id:"structure-4",level:4},{value:"Examples",id:"examples-4",level:4},{value:"Problem Reports",id:"problem-reports",level:3},{value:"Unresolved Questions",id:"unresolved-questions",level:2},{value:"Related Work",id:"related-work",level:2},{value:"Further Reading",id:"further-reading",level:2}],m={toc:c};function f(e){var t=e.components,l=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The IOTA DIDComm Specification is in the RFC phase and may undergo changes. Suggestions are welcome at ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/iotaledger/identity.rs/discussions/464"},"GitHub #464"),"."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Version: 0.1"),(0,i.kt)("li",{parentName:"ul"},"Status: ",(0,i.kt)("inlineCode",{parentName:"li"},"IN-PROGRESS")),(0,i.kt)("li",{parentName:"ul"},"Last Updated: 2021-10-29")),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"Allows a ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," to request a ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#credentials"},"verifiable credential")," from an ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer"),". The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," may alternatively initiate the issuance without a request from the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),". This protocol also allows the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," to request additional information and to offload the actual signing to a different party."),(0,i.kt)("h3",{id:"relationships"},"Relationships"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/identity.rs/specs/didcomm/protocols/presentation"},"Presentation"),": the ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer")," may request a ",(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#presentations-0"},"verifiable presentation")," from the ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"holder")," during the course of this protocol if additional information is required."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/identity.rs/specs/didcomm/protocols/signing"},"Signing"),": the ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer")," may delegate signing to another ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer")," if they lack the needed authority or private key, in which case the ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer")," takes on the role of ",(0,i.kt)("a",{parentName:"li",href:"/identity.rs/specs/didcomm/protocols/signing#roles"},"trusted-party"),".")),(0,i.kt)("h3",{id:"example-use-cases"},"Example Use-Cases"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A university issues a degree to a graduate that can be verified by potential employers."),(0,i.kt)("li",{parentName:"ul"},"A resident requests proof of address from their city council."),(0,i.kt)("li",{parentName:"ul"},"An insurer issues proof that a company has liability insurance.")),(0,i.kt)("h3",{id:"roles"},"Roles"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#dfn-holders"},"Holder"),": stores one or more verifiable credentials. A holder is usually but not always the ",(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#credential-subject-0"},"subject")," of those credentials."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#dfn-issuers"},"Issuer"),": creates verifiable credentials asserting claims about one or more ",(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model/#credential-subject-0"},"subjects"),", transmitted to a holder.")),(0,i.kt)("h3",{id:"interaction"},"Interaction"),(0,i.kt)("div",{style:{textAlign:"center"}},(0,i.kt)("p",null,(0,i.kt)("img",{alt:"IssuanceDiagram",src:a(90406).Z,width:"516",height:"1302"})),(0,i.kt)("sub",null,"For guidance on diagrams see the ",(0,i.kt)("a",{href:"../overview#diagrams"},"corresponding section in the overview"),".")),(0,i.kt)("h2",{id:"messages"},"Messages"),(0,i.kt)("h3",{id:"issuance-request"},"1. issuance-request"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type: ",(0,i.kt)("inlineCode",{parentName:"li"},"iota/issuance/0.1/issuance-request")),(0,i.kt)("li",{parentName:"ul"},"Role: ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"holder"))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," requests a single verifiable credential from the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," of a particular kind."),(0,i.kt)("h4",{id:"structure"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "subject": DID,                   // REQUIRED\n  "credentialInfo": CredentialInfo, // REQUIRED\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credential-subject-0"},(0,i.kt)("inlineCode",{parentName:"a"},"subject"))),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/did-core/#dfn-decentralized-identifiers"},"DID")," of the ",(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credential-subject-0"},"credential subject"),(0,i.kt)("sup",{parentName:"td",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1")),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"credentialInfo")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A ",(0,i.kt)("a",{parentName:"td",href:"../resources/credential-info"},"CredentialInfo")," object, specifying a credential kind requested by the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder"),".",(0,i.kt)("sup",{parentName:"td",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," ",(0,i.kt)("sup",{parentName:"td",id:"fnref-3"},(0,i.kt)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))," ",(0,i.kt)("sup",{parentName:"td",id:"fnref-4"},(0,i.kt)("a",{parentName:"sup",href:"#fn-4",className:"footnote-ref"},"4"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," is usually but not always the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#credential-subject-0"},"subject")," of the requested credential. There may be custodial, legal guardianship, or delegation situations where a third-party requests, or is issued a credential on behalf of a subject. It is the responsibility of the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," to ensure authorization in such cases."),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," The ",(0,i.kt)("inlineCode",{parentName:"p"},"credentialInfo")," could be hard-coded, communicated in-band, discovered out-of-band, or be pre-sent by an ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer"),". The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," SHOULD reject the request with a ",(0,i.kt)("inlineCode",{parentName:"p"},"problem-report")," if it does not support the requested ",(0,i.kt)("inlineCode",{parentName:"p"},"credentialInfo"),"."),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-3"},(0,i.kt)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))," With ",(0,i.kt)("a",{parentName:"p",href:"../resources/credential-info#credentialtype2021"},"CredentialType2021"),", the ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," MAY be under-specified if the exact type is unknown or if the resulting type depends on the identity or information of the subject or holder. E.g. the ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," could be as general as ",(0,i.kt)("inlineCode",{parentName:"p"},'["VerifiableCredential"]')," if the issuer issues only a singular type of credential or decides the credential based on other information related to the subject. "),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-4"},(0,i.kt)("a",{parentName:"sup",href:"#fn-4",className:"footnote-ref"},"4"))," With ",(0,i.kt)("a",{parentName:"p",href:"../resources/credential-info#credentialtype2021"},"CredentialType2021"),", the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," MAY specify one or more trusted issuers they would like to sign the resulting credential. The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," SHOULD reject the request with a ",(0,i.kt)("inlineCode",{parentName:"p"},"problem-report")," if it supports none of the requested ",(0,i.kt)("inlineCode",{parentName:"p"},"issuer")," entries. However, there are circumstances where an ",(0,i.kt)("inlineCode",{parentName:"p"},"issuer")," is no longer supported or was compromised, so this behavior should be decided based on the application."),(0,i.kt)("p",null,"An ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," wanting to preserve privacy regarding which exact credential kinds, types, or issuers they support should be careful with the information they disclose in ",(0,i.kt)("inlineCode",{parentName:"p"},"problem-reports")," when rejecting requests. E.g. a ",(0,i.kt)("inlineCode",{parentName:"p"},"problem-report")," with only a ",(0,i.kt)("inlineCode",{parentName:"p"},"reject-request")," descriptor discloses less information than the ",(0,i.kt)("inlineCode",{parentName:"p"},"reject-request.invalid-type")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"reject-request.invalid-trusted-issuer")," descriptors, as the latter two could be used to determine supported types or signing issuers by process of elimination."),(0,i.kt)("h4",{id:"examples"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Request any drivers licence credential using ",(0,i.kt)("a",{parentName:"li",href:"../resources/credential-info#credentialtype2021"},"CredentialType2021"),":")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "subject": "did:example:c6ef1fe11eb22cb711e6e227fbc",\n  "credentialInfo": {\n    "credentialInfoType": "CredentialType2021",\n    "type": ["VerifiableCredential", "DriversLicence"],\n  }\n}\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Request a university degree credential from either supported trusted issuer using ",(0,i.kt)("a",{parentName:"li",href:"../resources/credential-info#credentialtype2021"},"CredentialType2021"),":")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "subject": "did:example:c6ef1fe11eb22cb711e6e227fbc",\n  "credentialInfo": {\n    "credentialInfoType": "CredentialType2021",\n    "type": ["VerifiableCredential", "UniversityDegreeCredential", "BachelorOfArtsDegreeCredential"],\n    "issuer": ["did:example:76e12ec712ebc6f1c221ebfeb1f", "did:example:f1befbe122c1f6cbe217ce21e67"]\n  }\n}\n')),(0,i.kt)("h3",{id:"issuance-offer"},"2. issuance-offer"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type: ",(0,i.kt)("inlineCode",{parentName:"li"},"iota/issuance/0.1/issuance-offer")),(0,i.kt)("li",{parentName:"ul"},"Role: ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer"))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," offers a single, unsigned credential to the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),", matching the preceding ",(0,i.kt)("a",{parentName:"p",href:"#issuance-request"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-request"))," if present. The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," may set an expiry date for the offer and require non-repudiable proof by the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," that the offer was received."),(0,i.kt)("h4",{id:"structure-1"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "unsignedCredential": Credential, // REQUIRED\n  "offerChallenge": {\n    "challenge": string,            // REQUIRED\n    "credentialHash": string,       // REQUIRED\n  }, // OPTIONAL\n  "offerExpiry": DateTime           // OPTIONAL\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credentials"},(0,i.kt)("inlineCode",{parentName:"a"},"unsignedCredential"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"Unsigned ",(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credentials"},"credential")," being offered to the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder"),". This MUST NOT include a ",(0,i.kt)("inlineCode",{parentName:"td"},"proof")," section."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"If present, indicates the ",(0,i.kt)("a",{parentName:"td",href:"#issuer"},"issuer")," requires the acceptance of the credential to be signed by the ",(0,i.kt)("a",{parentName:"td",href:"#holder"},"holder")," in the following ",(0,i.kt)("a",{parentName:"td",href:"#issuance-response"},"issuance-response")," for non-repudiation.",(0,i.kt)("sup",{parentName:"td",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"challenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A random string that should be unique per ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},"issuance-offer"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"credentialHash")),(0,i.kt)("td",{parentName:"tr",align:"left"},"The ",(0,i.kt)("a",{parentName:"td",href:"https://tools.ietf.org/id/draft-msporny-base58-01.html"},"Base58"),"-encoded ",(0,i.kt)("a",{parentName:"td",href:"https://www.rfc-editor.org/rfc/rfc4634"},"SHA-256 digest")," of the ",(0,i.kt)("inlineCode",{parentName:"td"},"unsignedCredential")," formatted according to the ",(0,i.kt)("a",{parentName:"td",href:"https://tools.ietf.org/id/draft-rundgren-json-canonicalization-scheme-00.html"},"JSON Canonicalization Scheme"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"offerExpiry")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A string formatted as an ",(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/xmlschema11-2/#dateTime"},"XML DateTime")," normalized to UTC 00:00:00 and without sub-second decimal precision. E.g: ",(0,i.kt)("inlineCode",{parentName:"td"},'"2021-12-30T19:17:47Z"'),".",(0,i.kt)("sup",{parentName:"td",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," Issuing challenges should be done with due consideration to security and privacy concerns: not all applications require non-repudiation to third-parties and a ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/hyperledger/aries-rfcs/blob/main/concepts/0049-repudiation/README.md#summary"},"may wish to deny that they ever requested or accepted a particular credential"),". The challenge SHOULD NOT be used for authentication of the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),"; see the ",(0,i.kt)("a",{parentName:"p",href:"./authencation"},"authentication")," protocol and ",(0,i.kt)("a",{parentName:"p",href:"https://identity.foundation/didcomm-messaging/spec/#sender-authenticated-encryption"},"sender authenticated encryption"),"."),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," If present, an ",(0,i.kt)("inlineCode",{parentName:"p"},"offerExpiry")," indicates that the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," MAY rescind the offer and abandon the protocol if an affirmative ",(0,i.kt)("a",{parentName:"p",href:"#issuance-response"},"issuance-response")," is not received before the specified datetime. Note that the ",(0,i.kt)("inlineCode",{parentName:"p"},"offerExpiry")," should override any default message timeouts."),(0,i.kt)("h4",{id:"examples-1"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Offer a degree credential:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "unsignedCredential": {\n    "@context": [\n      "https://www.w3.org/2018/credentials/v1",\n      "https://www.w3.org/2018/credentials/examples/v1"\n    ],\n    "id": "6c1a1477-e452-4da7-b2db-65ad0b369d1a",\n    "type": ["VerifiableCredential", "UniversityDegreeCredential"],\n    "issuer": "did:example:76e12ec712ebc6f1c221ebfeb1f",\n    "issuanceDate": "2021-05-03T19:73:24Z",\n    "credentialSubject": {\n      "id": "did:example:ebfeb1f712ebc6f1c276e12ec21",\n      "degree": {\n        "type": "BachelorDegree",\n        "name": "Bachelor of Science and Arts"\n      }\n    }\n  }\n}\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"A time-limited offer for a degree credential with a signature requested:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "unsignedCredential": {\n    "@context": [\n      "https://www.w3.org/2018/credentials/v1",\n      "https://www.w3.org/2018/credentials/examples/v1"\n    ],\n    "id": "6c1a1477-e452-4da7-b2db-65ad0b369d1a",\n    "type": ["VerifiableCredential", "UniversityDegreeCredential"],\n    "issuer": "did:example:76e12ec712ebc6f1c221ebfeb1f",\n    "issuanceDate": "2021-01-05T19:37:24Z",\n    "credentialSubject": {\n      "id": "did:example:ebfeb1f712ebc6f1c276e12ec21",\n      "degree": {\n        "type": "BachelorDegree",\n        "name": "Bachelor of Science and Arts"\n      }\n    }\n  },\n  "offerChallenge": {\n    "challenge": "d7b7869e-fec3-4de9-84bb-c3a43bacff33",\n    "credentialHash": "28Ae7AdqzyMyF9pmnwUNK1Q7VT3EzDDGEj1Huk7uYQT94KYAhQzEPyhoF5Ugs3totUugLPpghGmE9HaG8usJZcZv",\n  },\n  "offerExpiry": "2021-01-05T20:07:24Z"\n}\n')),(0,i.kt)("h3",{id:"issuance-response"},"3. issuance-response"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type: ",(0,i.kt)("inlineCode",{parentName:"li"},"iota/issuance/0.1/issuance-response")),(0,i.kt)("li",{parentName:"ul"},"Role: ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"holder"))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," responds to a ",(0,i.kt)("a",{parentName:"p",href:"#issuance-offer"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-offer"))," by accepting or disputing the offer and optionally signing the response for non-repudiation."),(0,i.kt)("h4",{id:"structure-2"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "accepted": bool,             // REQUIRED\n  "disputes": [Dispute],        // OPTIONAL\n  "signature": {\n    "offerChallenge": {\n      "challenge": string,      // REQUIRED\n      "credentialHash": string, // REQUIRED\n    }, // REQUIRED\n    "proof": Proof,             // REQUIRED\n  } // OPTIONAL\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"accepted")),(0,i.kt)("td",{parentName:"tr",align:"left"},"Indicates if the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder")," accepts the offered credential from ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-offer")),". MUST be ",(0,i.kt)("inlineCode",{parentName:"td"},"false")," if any ",(0,i.kt)("inlineCode",{parentName:"td"},"disputes")," are present."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#disputes"},(0,i.kt)("inlineCode",{parentName:"a"},"disputes"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"Allows the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder")," to ",(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#disputes"},(0,i.kt)("inlineCode",{parentName:"a"},"dispute"))," one or more claims in the credential."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"signature")),(0,i.kt)("td",{parentName:"tr",align:"left"},"This SHOULD be present if a ",(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge")," was included in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-offer")),".",(0,i.kt)("sup",{parentName:"td",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"This MUST match the ",(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge")," in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-offer")),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://w3c-ccg.github.io/ld-proofs/"},(0,i.kt)("inlineCode",{parentName:"a"},"proof"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"Signature of the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder")," on the ",(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," A valid ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," allows the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," to prove that the credential was accepted by the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),". If present, the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," MUST validate the ",(0,i.kt)("inlineCode",{parentName:"p"},"proof")," is correct and signed with an unrevoked ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/did-core/#dfn-verification-method"},"verification method"),", and issue a problem-report if not. The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," SHOULD terminate the protocol if no ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," is present and a ",(0,i.kt)("inlineCode",{parentName:"p"},"offerChallenge")," was included in the preceding ",(0,i.kt)("a",{parentName:"p",href:"#issuance-offer"},"issuance-offer")," message. An explicit ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," is used instead of a ",(0,i.kt)("a",{parentName:"p",href:"https://identity.foundation/didcomm-messaging/spec/#didcomm-signed-message"},"signed DIDComm message")," to avoid the need to store the entire credential for auditing purposes; the hash is sufficient to prove a particular credential was accepted."),(0,i.kt)("h4",{id:"examples-2"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Accept a credential offer:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "accepted": true,\n  "disputes": [],\n}\n')),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Accept a credential offer including a signature:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "accepted": true,\n  "disputes": [],\n  "signature": {\n    "offerChallenge": {\n      "challenge": "d7b7869e-fec3-4de9-84bb-c3a43bacff33",\n      "credentialHash": "28Ae7AdqzyMyF9pmnwUNK1Q7VT3EzDDGEj1Huk7uYQT94KYAhQzEPyhoF5Ugs3totUugLPpghGmE9HaG8usJZcZv",\n    },\n    "proof": {...}\n  }\n}\n')),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"Reject a credential offer with disputes:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "accepted": false,\n  "disputes": [{\n    "@context": [\n      "https://www.w3.org/2018/credentials/v1",\n    ],\n    "id": "6e8e989e-749e-4ed8-885b-b2a2bb64835f",\n    "type": ["VerifiableCredential", "DisputeCredential"],\n    "credentialSubject": {\n      "id": "6c1a1477-e452-4da7-b2db-65ad0b369d1a",\n      "currentStatus": "Disputed",\n      "statusReason": {\n        "value": "Incorrect name.",\n        "lang": "en"\n      },\n    },\n    "issuer": "did:example:ebfeb1f712ebc6f1c276e12ec21",\n    "issuanceDate": "2021-01-05T19:46:24Z",\n    "proof": {...}\n  }],\n}\n')),(0,i.kt)("h3",{id:"issuance-message"},"4. issuance"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type: ",(0,i.kt)("inlineCode",{parentName:"li"},"iota/issuance/0.1/issuance")),(0,i.kt)("li",{parentName:"ul"},"Role: ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"issuer"))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," transmits the signed credential following a ",(0,i.kt)("a",{parentName:"p",href:"#issuance-response"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance-response"))," by the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),". The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," may set an expiry until when they expect an acknowledgment and request a cryptographic signature in the acknowledgment for non-repudiation. "),(0,i.kt)("h4",{id:"structure-3"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "signedCredential": Credential,   // REQUIRED\n  "issuanceChallenge": {\n    "challenge": string,            // REQUIRED\n    "credentialHash": string,       // REQUIRED\n  }, // OPTIONAL\n  "issuanceExpiry": DateTime,       // OPTIONAL\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credentials"},(0,i.kt)("inlineCode",{parentName:"a"},"signedCredential"))),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/vc-data-model/#credentials"},"Verifiable credential")," signed by the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"issuer"),".",(0,i.kt)("sup",{parentName:"td",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"If present, indicates the ",(0,i.kt)("a",{parentName:"td",href:"#issuer"},"issuer")," requires the ",(0,i.kt)("a",{parentName:"td",href:"#issuance-acknowledgement"},"issuance-acknowledgement")," of the credential to be signed for non-repudiation."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"challenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A random string that should be unique per ",(0,i.kt)("a",{parentName:"td",href:"#issuance"},"issuance"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"credentialHash")),(0,i.kt)("td",{parentName:"tr",align:"left"},"The ",(0,i.kt)("a",{parentName:"td",href:"https://tools.ietf.org/id/draft-msporny-base58-01.html"},"Base58"),"-encoded ",(0,i.kt)("a",{parentName:"td",href:"https://www.rfc-editor.org/rfc/rfc4634"},"SHA-256 digest")," of the ",(0,i.kt)("inlineCode",{parentName:"td"},"signedCredential"),", including the ",(0,i.kt)("inlineCode",{parentName:"td"},"proof"),", formatted according to the ",(0,i.kt)("a",{parentName:"td",href:"https://tools.ietf.org/id/draft-rundgren-json-canonicalization-scheme-00.html"},"JSON Canonicalization Scheme"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"issuanceExpiry")),(0,i.kt)("td",{parentName:"tr",align:"left"},"A string formatted as an ",(0,i.kt)("a",{parentName:"td",href:"https://www.w3.org/TR/xmlschema11-2/#dateTime"},"XML Datetime")," normalized to UTC 00:00:00 and without sub-second decimal precision indicating when the offer expires. E.g: ",(0,i.kt)("inlineCode",{parentName:"td"},'"2021-12-30T19:17:47Z"'),".",(0,i.kt)("sup",{parentName:"td",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," SHOULD validate both that the ",(0,i.kt)("inlineCode",{parentName:"p"},"proof")," on the ",(0,i.kt)("inlineCode",{parentName:"p"},"signedCredential")," is correctly signed by a trusted issuer and that the contents match those of the ",(0,i.kt)("inlineCode",{parentName:"p"},"unsignedCredential")," from the ",(0,i.kt)("a",{parentName:"p",href:"#issuance-offer"},"issuance-offer")," they accepted. If not, a relevant problem-report should be sent."),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-2"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," SHOULD send a problem-report if the ",(0,i.kt)("inlineCode",{parentName:"p"},"issuanceExpiry")," datetime passes without receiving an ",(0,i.kt)("a",{parentName:"p",href:"#issuance-acknowledgement"},"issuance-acknowledgement")," message from the ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder"),". The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," MAY revoke the credential in this case."),(0,i.kt)("h4",{id:"examples-3"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Issuing a credential including expiry and requesting proof:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n "unsignedCredential": {\n    "@context": [\n      "https://www.w3.org/2018/credentials/v1",\n      "https://www.w3.org/2018/credentials/examples/v1"\n    ],\n    "id": "6c1a1477-e452-4da7-b2db-65ad0b369d1a",\n    "type": ["VerifiableCredential", "UniversityDegreeCredential"],\n    "issuer": "did:example:76e12ec712ebc6f1c221ebfeb1f",\n    "issuanceDate": "2021-01-05T19:37:24Z",\n    "credentialSubject": {\n      "id": "did:example:ebfeb1f712ebc6f1c276e12ec21",\n      "degree": {\n        "type": "BachelorDegree",\n        "name": "Bachelor of Science and Arts"\n      }\n    },\n    "proof": {\n      "type": "JcsEd25519Signature2020",\n      "verificationMethod": "did:example:ebfeb1f712ebc6f1c276e12ec21#key",\n      "signatureValue": "3KpeHSW4LybMy1smFEYriRmj5FsFfnxQiEsBnQdYzwkXMnjF3Jjn5RS1KGzheNpUgHW5yua8DoLbfYmZFAvaUVwv"\n    }\n  },\n  "issuanceChallenge": {\n    "challenge": "6ff5f616-2f9c-4e47-b9d2-5553deeac01d",\n    "credentialHash": "21DtABsnYNb7oGEY8aybb9Bghq6NJJWvrQgtC2SBdhgQ8v6cZGjnT8RmEmBLZfHyfEYMAik3D1EoNQZCaT4RUKEX",\n  },\n  "issuanceExpiry": "2021-01-05T20:07:24Z"\n}\n')),(0,i.kt)("h3",{id:"issuance-acknowledgment"},"5. issuance-acknowledgment"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Type: ",(0,i.kt)("inlineCode",{parentName:"li"},"iota/issuance/0.1/issuance-acknowledgment")),(0,i.kt)("li",{parentName:"ul"},"Role: ",(0,i.kt)("a",{parentName:"li",href:"#roles"},"holder"))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"holder")," confirms receipt of a successful credential ",(0,i.kt)("a",{parentName:"p",href:"#issuance-message"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance")),", optionally including non-repudiable proof."),(0,i.kt)("h4",{id:"structure-4"},"Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "signature": {\n    "issuanceChallenge": {\n      "challenge": string,      // REQUIRED\n      "credentialHash": string, // REQUIRED\n    }, // REQUIRED\n    "proof": Proof,             // REQUIRED\n  } // OPTIONAL\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Required"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"signature")),(0,i.kt)("td",{parentName:"tr",align:"left"},"This SHOULD be present if a ",(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge")," was included in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance"))," message.",(0,i.kt)("sup",{parentName:"td",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2716")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge")),(0,i.kt)("td",{parentName:"tr",align:"left"},"This MUST match the ",(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge")," in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},(0,i.kt)("inlineCode",{parentName:"a"},"issuance"))," message."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"https://w3c-ccg.github.io/ld-proofs/"},(0,i.kt)("inlineCode",{parentName:"a"},"proof"))),(0,i.kt)("td",{parentName:"tr",align:"left"},"Signature of the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder")," on the ",(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge"),"."),(0,i.kt)("td",{parentName:"tr",align:"left"},"\u2714")))),(0,i.kt)("p",null,(0,i.kt)("sup",{parentName:"p",id:"fnref-1"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," The ",(0,i.kt)("a",{parentName:"p",href:"#roles"},"issuer")," MUST validate the ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," and MAY revoke the issued credential if a ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," was requested, e.g. for non-repudiation or auditing, and not received or an invalid ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," is received. An explicit ",(0,i.kt)("inlineCode",{parentName:"p"},"signature")," is used instead of a ",(0,i.kt)("a",{parentName:"p",href:"https://identity.foundation/didcomm-messaging/spec/#didcomm-signed-message"},"signed DIDComm message")," to avoid the need to store the entire credential for auditing purposes as the hash is sufficient to prove a particular credential was accepted."),(0,i.kt)("h4",{id:"examples-4"},"Examples"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Acknowledge receipt of the credential:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},"{}\n")),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"Acknowledge receipt of the credential including a signature:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "signature": {\n    "issuanceChallenge": {\n      "challenge": "6ff5f616-2f9c-4e47-b9d2-5553deeac01d",\n      "credentialHash": "21DtABsnYNb7oGEY8aybb9Bghq6NJJWvrQgtC2SBdhgQ8v6cZGjnT8RmEmBLZfHyfEYMAik3D1EoNQZCaT4RUKEX",\n    },\n    "proof": {...}\n  }\n}\n')),(0,i.kt)("h3",{id:"problem-reports"},"Problem Reports"),(0,i.kt)("p",null,"The following problem-report codes may be raised in the course of this protocol and are expected to be recognised and handled in addition to any general problem-reports. Implementers may also introduce their own application-specific problem-reports."),(0,i.kt)("p",null,"For guidance on problem-reports and a list of general codes see ",(0,i.kt)("a",{parentName:"p",href:"../resources/problem-reports"},"problem reports"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Code"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Message"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-request")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-request"},"issuance-request")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects a credential request for any reason, e.g. unrecognised or invalid type, trusted issuer, or subject.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-request.invalid-subject")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-request"},"issuance-request")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects a credential request due to the ",(0,i.kt)("inlineCode",{parentName:"td"},"subject")," being unrecognised, missing, or otherwise invalid.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-request.invalid-type")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-request"},"issuance-request")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects a credential request due to the ",(0,i.kt)("inlineCode",{parentName:"td"},"type")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"@context")," being unsupported or otherwise invalid.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-request.invalid-issuer")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-request"},"issuance-request")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects a credential request due to ",(0,i.kt)("inlineCode",{parentName:"td"},"trustedIssuers")," being unrecognised, unsupported or otherwise invalid.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.presentation-failed")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},"issuance-offer")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," terminates the protocol due to a failed ",(0,i.kt)("a",{parentName:"td",href:"./presentation"},"presentation")," request for more information prior to a ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},"issuance-offer"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-response.missing-signature")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-response"},"issuance-response")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects an ",(0,i.kt)("a",{parentName:"td",href:"#issuance-response"},"issuance-response")," missing a ",(0,i.kt)("inlineCode",{parentName:"td"},"signature")," when ",(0,i.kt)("inlineCode",{parentName:"td"},"offerChallenge")," was included in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},"issuance-offer")," message.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-issuance")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},"issuance")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Holder")," rejects a credential issuance for any reason, e.g. mismatch with the credential in the ",(0,i.kt)("a",{parentName:"td",href:"#issuance-offer"},"issuance-offer"),". Note that disputes are handled in ",(0,i.kt)("a",{parentName:"td",href:"#issuance-response"},"issuance-response")," prior to ",(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},"issuance"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.expired")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},"issuance")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," notifies the ",(0,i.kt)("a",{parentName:"td",href:"#roles"},"holder")," that an ",(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},"issuance")," message has expired without a valid ",(0,i.kt)("a",{parentName:"td",href:"#issuance-acknowledgement"},"issuance-acknowledgement"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("inlineCode",{parentName:"td"},"e.p.msg.iota.issuance.reject-acknowledgement.missing-signature")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#issuance-acknowledgement"},"issuance-acknowledgement")),(0,i.kt)("td",{parentName:"tr",align:"left"},(0,i.kt)("a",{parentName:"td",href:"#roles"},"Issuer")," rejects an ",(0,i.kt)("a",{parentName:"td",href:"#issuance-acknowledgement"},"issuance-acknowledgement")," missing a ",(0,i.kt)("inlineCode",{parentName:"td"},"signature")," when ",(0,i.kt)("inlineCode",{parentName:"td"},"issuanceChallenge")," was included in the preceding ",(0,i.kt)("a",{parentName:"td",href:"#issuance-message"},"issuance")," message.")))),(0,i.kt)("h2",{id:"unresolved-questions"},"Unresolved Questions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"credentialSubject::id")," field of a verifiable credential is optional and not always a DID according to the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model"},"verifiable credential specification"),". Should we enforce that it is always a DID? This affects presentations are noted in the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#subject-holder-relationships"},"subject-holder relationships section of the specification"),". We essentially enforce the ",(0,i.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/vc-data-model/#nontransferable-property"},(0,i.kt)("inlineCode",{parentName:"a"},"nonTransferable")," property")," for all credentials in our presentations currently to prevent verifiers storing and re-presenting credentials as their own.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"e.p.msg.iota.issuance.reject-request.invalid-type")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"e.p.msg.iota.issuance.reject-request.invalid-issuer")," are specific to ",(0,i.kt)("a",{parentName:"p",href:"../resources/credential-info#credentialtype2021"},"CredentialType2021"),". Should they be listed here? If yes, should they be marked accordingly?"))),(0,i.kt)("h2",{id:"related-work"},"Related Work"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Aries Hyperledger: ",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/hyperledger/aries-rfcs/blob/08653f21a489bf4717b54e4d7fd2d0bdfe6b4d1a/features/0036-issue-credential/README.md"},"https://github.com/hyperledger/aries-rfcs/blob/08653f21a489bf4717b54e4d7fd2d0bdfe6b4d1a/features/0036-issue-credential/README.md")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/hyperledger/aries-rfcs/blob/08653f21a489bf4717b54e4d7fd2d0bdfe6b4d1a/features/0453-issue-credential-v2/README.md"},"https://github.com/hyperledger/aries-rfcs/blob/08653f21a489bf4717b54e4d7fd2d0bdfe6b4d1a/features/0453-issue-credential-v2/README.md"))))),(0,i.kt)("h2",{id:"further-reading"},"Further Reading"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/did-core/"},"Decentralized Identifiers (DIDs) 1.0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.w3.org/TR/vc-data-model"},"Verifiable Credentials Data Model 1.0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://w3c.github.io/vc-imp-guide/"},"Verifiable Credentials Implementation Guidelines 1.0"))))}f.isMDXComponent=!0},90406:function(e,t,a){t.Z=a.p+"assets/images/issuance.drawio-5d72dc0bbe4fdc540a4bc01c1f584b93.svg"},3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return f}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=n.createContext({}),d=function(e){var t=n.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(o.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(a),f=r,u=m["".concat(o,".").concat(f)]||m[f]||c[f]||i;return a?n.createElement(u,s(s({ref:t},p),{},{components:a})):n.createElement(u,s({ref:t},p))}));function f(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var d=2;d<i;d++)s[d]=a[d];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);