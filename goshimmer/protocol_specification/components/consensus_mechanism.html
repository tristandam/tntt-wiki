<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-goshimmer docs-doc-id-protocol_specification/components/consensus_mechanism">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TNTT Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TNTT Wiki Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="TNTT Wiki" href="/opensearch.xml">
<link rel="preconnect" href="${matomoUrl}">
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var a="https://matomo.antonionardella.it/";_paq.push(["setTrackerUrl",a+"matomo.php"]),_paq.push(["setSiteId","6"]);var e=document,t=e.createElement("script"),p=e.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=a+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>
<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:2809821,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-rh="true">consensus_mechanism | TNTT Wiki</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tntt-wiki.github.io/img/learn/tntt_logo.jpg"><meta data-rh="true" name="twitter:image" content="https://tntt-wiki.github.io/img/learn/tntt_logo.jpg"><meta data-rh="true" property="og:url" content="https://tntt-wiki.github.io/goshimmer/protocol_specification/components/consensus_mechanism"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-goshimmer-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-goshimmer-current"><meta data-rh="true" property="og:title" content="consensus_mechanism | TNTT Wiki"><meta data-rh="true" name="description" content="The consensus mechanism is necessary to achieve agreement among the nodes of the network.  Since the Tangle is only partially ordered we have designed an open and leaderless consensus mechanism which combines FPC and Approval Weight."><meta data-rh="true" property="og:description" content="The consensus mechanism is necessary to achieve agreement among the nodes of the network.  Since the Tangle is only partially ordered we have designed an open and leaderless consensus mechanism which combines FPC and Approval Weight."><meta data-rh="true" name="keywords" content="node,approval weight,branch,opinion,message,high probability,active consensus mana"><link data-rh="true" rel="icon" href="/img/learn/tntt_logo.jpg"><link data-rh="true" rel="canonical" href="https://tntt-wiki.github.io/goshimmer/protocol_specification/components/consensus_mechanism"><link data-rh="true" rel="alternate" href="https://tntt-wiki.github.io/goshimmer/protocol_specification/components/consensus_mechanism" hreflang="en"><link data-rh="true" rel="alternate" href="https://tntt-wiki.github.io/goshimmer/protocol_specification/components/consensus_mechanism" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YTLE56KAO4-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.79458214.css">
<link rel="preload" href="/assets/js/runtime~main.8139a13d.js" as="script">
<link rel="preload" href="/assets/js/main.a258838c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:#7da7ff;color:#000000" role="banner"><div class="announcementBarContent_KsVm">Would you like to correct/contribute a resource or guide? <a target="_blank" href="https://assembly.sc">Click here</a> for instructions.</div></div><nav class="navbar navbar--fixed-top navbarHideable_ObN2"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/learn/tntt_logo.jpg" alt="TNTT Wiki Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/learn/tntt_logo.jpg" alt="TNTT Wiki Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><a class="navbar__item navbar__link" href="/learn/about-iota/an-introduction-to-iota"><div class="link"><div class="link__body"><div class="link__label">Au Nhi</div></div></div></a><a class="navbar__item navbar__link" href="/participate/support-the-network/about-nodes"><div class="link"><div class="link__body"><div class="link__label">Thieu Nhi</div></div></div></a><a class="navbar__item navbar__link" href="/participate/support-the-network/about-nodes"><div class="link"><div class="link__body"><div class="link__label">Nghia Si</div></div></div></a><a class="navbar__item navbar__link" href="/participate/support-the-network/about-nodes"><div class="link"><div class="link__body"><div class="link__label">Participate</div></div></div></a><a class="navbar__item navbar__link" href="/participate/support-the-network/about-nodes"><div class="link"><div class="link__body"><div class="link__label">Huynh Truong</div></div></div></a><div class="dropdown dropdown--hoverable dropdown--mega"><a class="navbar__item navbar__link navbar__link--active"><div class="link"><div class="link__body"><div class="link__label">Build | GoShimmer Node</div></div></div></a><div class="dropdown__container"><div class="dropdown__menu"><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Getting Started</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Chrysalis (IOTA 1.5)</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Libraries</div></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Smart Contracts</div></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/build/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Getting Started</div><div class="link__sublabel">IOTA development basics</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/chrysalis-docs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Chrysalis Docs</div><div class="link__sublabel">Mainnet documentation</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/iota.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Client</div><div class="link__sublabel">Interact with the IOTA network</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/smart-contracts/overview"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Wasp Node</div><div class="link__sublabel">Smart contract node</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Integrations</div></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/bee/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Bee Node</div><div class="link__sublabel">IOTA node written in Rust</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/wallet.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Wallet</div><div class="link__sublabel">Build IOTA wallets</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><div class="dropdown__label">Coordicide (IOTA 2.0)</div></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/integration-services/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Streams and Identity</div><div class="link__sublabel">Integrate IOTA seamlessly</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/hornet/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Hornet Node</div><div class="link__sublabel">IOTA node written in Go</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/stronghold.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Stronghold</div><div class="link__sublabel">Handle secrets securely</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/IOTA-2.0-Research-Specifications/Preface"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Coordicide Specs</div><div class="link__sublabel">Decentralizing IOTA</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/chronicle.rs/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Chronicle Permanode</div><div class="link__sublabel">IOTA permanode</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/identity.rs/introduction"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Identity</div><div class="link__sublabel">Identity framework</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"><a aria-current="page" class="dropdown__link dropdown__link--active" href="/goshimmer/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">GoShimmer Node</div><div class="link__sublabel">IOTA 2.0 node</div></div></div></a></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"><a class="dropdown__link" href="/streams/welcome"><div class="link"><div class="link__icon"></div><div class="link__body"><div class="link__label">Streams</div><div class="link__sublabel">Share data securely</div></div></div></a></div><div class="col margin-horiz--xs dropdown__col"></div></div><div class="row row--no-gutters dropdown__row"><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"></div><div class="col margin-horiz--xs dropdown__col"></div></div></div></div></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog"><div class="link"><div class="link__body"><div class="link__label">Contribute</div></div></div></a><a class="navbar__item navbar__link" href="/about"><div class="link"><div class="link__body"><div class="link__label">About</div></div></div></a><a class="navbar__item navbar__link" href="/team"><div class="link"><div class="link__body"><div class="link__label">Team</div></div></div></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD sidebarWithHideableNavbar_d0QC"><a tabindex="-1" class="sidebarLogo_YUvz" href="/"><img src="/img/learn/tntt_logo.jpg" alt="TNTT Wiki Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/learn/tntt_logo.jpg" alt="TNTT Wiki Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></a><nav class="menu thin-scrollbar menu_izAj menuWithAnnouncementBar_l2a_"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/goshimmer/welcome">Welcome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/goshimmer/faq">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/goshimmer/tutorials/setup">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/goshimmer/implementation_design/event_driven_model">Implementation design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/goshimmer/protocol_specification/overview">Protocol Specification</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/overview">Protocol Specification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/protocol">Protocol High Level Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/goshimmer/protocol_specification/components/overview">Components</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/tangle">Tangle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/autopeering">Autopeering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/mana">Mana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/congestion_control">Congestion Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/goshimmer/protocol_specification/components/consensus_mechanism">Consensus Mechanism</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/ledgerstate">UTXO and Ledgerstate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/advanced_outputs">Advanced Outputs (Experimental)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/components/markers">Markers</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/goshimmer/protocol_specification/glossary">Glossary</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/goshimmer/apis/client_lib">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/goshimmer/tooling/overview">Tooling</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/goshimmer/teamresources/release">Team Resources</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/iotaledger/goshimmer/releases" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_tcZa">Release Notes<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>consensus_mechanism</h1></header><h1>Consensus Mechanism</h1><p>The consensus mechanism is necessary to achieve agreement among the nodes of the network. In case of a double spend, one way to decide which transaction should be considered valid would be to order them and pick the oldest one. However, the Tangle is only partially ordered. To tackle this problem in the context of the Tangle, we have designed an open and leaderless consensus mechanism that utilizes the Tangle as a medium to exchange votes. Any node can add a message to the Tangle, and each message added to the Tangle represents a virtual vote (i.e. there is no additional overhead to communicate votes) to its entire past.</p><p>The consensus mechanism can broadly be devided into consensus on two separate entities. On the one hand, we need to resolve any conflicts on the underlying UTXO ledger to prevent double spends. On the other hand, we need to make sure that messages within the Tangle are not orphaned. Both are simply derived by observing the Tangle and objectively keeping track of <a href="#Approval-Weight-AW">Approval Weight (AW)</a> with cMana (more specifically <a href="#Active-cMana">active cMana</a>) as a Sibyl protection. Once a <a href="/goshimmer/protocol_specification/components/ledgerstate#branches">branch</a> (or message) reaches a certain AW threshold, an application can consider it as <em>confirmed</em>. To simplify this notion we introduce <a href="#Grades-of-Finality-GoF">Grades of Finality (GoF)</a> where a higher GoF represents a higher confidence.</p><table><thead><tr><th>Name</th><th>Component</th><th>Initial/local opinion</th><th>Consensus</th><th>Comparable blockchain mechanism for voting/finality</th></tr></thead><tbody><tr><td>voting on conflicts</td><td>UTXO ledger</td><td>OTV/FPCS</td><td>branch/tx AW</td><td>longest chain rule</td></tr><tr><td>finality of messages</td><td>Tangle</td><td>inclusion score via tip selection</td><td>message AW</td><td>x block rule</td></tr></tbody></table><p>On an abstract level, a node can be seen as a replicated state machine, just following whatever it receives through the Tangle, and, in case of messages containing transactions, modifying the UTXO ledger. Only when a node wants to issue a message (read as: <em>cast a vote</em>) it needs to evaluate its own local opinion via <a href="#Modular-Conflict-Selection-Function">modular conflict selection function</a>. This decoupling of coming to consensus and setting the initial opinion allows for great flexibility and separation of concerns.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="approval-weight-aw">Approval Weight (AW)<a class="hash-link" href="#approval-weight-aw" title="Direct link to heading">​</a></h2><p>Approval weight represents the <a href="#active-consensus-mana">weight</a> of branches (and messages), similar to the longest chain rule in Nakamoto consensus. However, instead of selecting a leader based on a puzzle (PoW) or stake (PoS), it allows every node to express its opinion by simply issuing any message and attaching it in a part of the Tangle it <em>likes</em> (based on its initial opinion on messages and possibly utilizing the <a href="#Like-Switch">like switch</a> to express its opinion on branches).</p><p>It is important to note that tracking of AW for branches and markers/messages is orthogonal. Thus, a message can reach a high AW whereas its contained payload, e.g., a transaction being a double spend, does not reach any AW on branch/UTXO level.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="detailed-design">Detailed Design<a class="hash-link" href="#detailed-design" title="Direct link to heading">​</a></h3><p>Approval weight AW increases because of voters (nodes) that cast votes for branches and messages by means of making statements. This is necessary due to the changing nature of cMana over time, which prevents simply counting the AW per branch or message. Additionally, whenever a node changes its opinion on a conflict, the previous vote needs to be invalidated.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="definitions">Definitions<a class="hash-link" href="#definitions" title="Direct link to heading">​</a></h4><ul><li><strong>Statement</strong>: A statement is any message issued by a <em>node</em>, expressing its opinion and casting a (virtual) vote. It can be objectively ordered by its timestamp, and, if equal, its message ID.</li><li><strong>Branch voter</strong>: A branch voter is a <em>node</em> that issued a statement attaching to a branch, and, thus, voting for it.</li><li><strong>Marker/message voter</strong>: A marker/message&#x27;s voter is a <em>node</em> that issued a statement directly or indirectly referencing a marker/message, including its issuer.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="branches">Branches<a class="hash-link" href="#branches" title="Direct link to heading">​</a></h4><p>Tracking voters of <a href="/goshimmer/protocol_specification/components/ledgerstate#branches">branches</a> is an effective way of objective virtual voting. It allows nodes to express their opinion simply by attaching a statement to a branch they like (see <a href="#Like-Switch">like switch</a>). This statement needs to propagate down the branch DAG, adding support to each of the branch&#x27;s parents. In case a voter changes their opinion, support needs to be revoked from all conflicting branches and their children. Thus, a node can only support one branch of a conflict set.</p><p>To make this more clear consider the following example:</p><p><a target="_blank" href="/assets/files/branches-c9cf5799719defb8d88961bbdcf5a7d5.png"><img loading="lazy" alt="Branch Voter" src="/assets/images/branches-c9cf5799719defb8d88961bbdcf5a7d5.png" width="1838" height="1262" class="img_E7b_"></a></p><p>The green node issued <strong>statement 1</strong> and attached it to the aggregated branch <code>Branch 1.1 + Branch 4.1.1</code>. Thus, the green node is a voter of all the aggregated branch&#x27;s parent branches, which are (from top to bottom) <code>Branch 4.1.1</code>, <code>Branch 1.1</code>, <code>Branch 4.1</code>, <code>Branch 1</code>, and <code>Branch 4</code>.</p><p>Then, the green node issued <strong>statement 2</strong> and attached it to <code>Branch 4.1.2</code>. This makes the green node a voter of <code>Branch 4.1.2</code>, however, <code>Branch 4.1.1</code> is its conflict branch and thus support for <code>Branch 4.1.1</code> has to be revoked.</p><p><code>Branch 4.1</code>, <code>Branch 4</code> are parent branches of <code>Branch 4.1.2</code>, which the green node is still supporting. Since <code>Branch 1.1</code>, <code>Branch 1</code> are not conflicting to either of <code>Branch 4.1.2</code>&#x27;s parents, the green node remains their voter.</p><p>Finally, the green nodes issued <strong>statement 3</strong>, which is in <code>Branch 2</code>. Now the green node is a voter of <code>Branch 2</code>, and no longer a voter of <code>Branch 1</code>, since <code>Branch 1</code> is conflicting to <code>Branch 2</code>. Note that, this voter removal will propagate to child branches. Thus, the green node is removed from <code>Branch 1.1</code> as well.
<code>Branch 3</code>, <code>4</code> and both of their child branches have nothing to do with this attachement, the voter status remains.</p><p>It is important to notice that the arrival order of the statements does not make a difference on the final outcome. Due to the fact that statements can be ordered objectively, every node in the network eventually comes to the same conclusion as to who is supporting which branch, even when nodes change their opinions.</p><h5 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="calculation-of-approval-weight">Calculation of Approval Weight<a class="hash-link" href="#calculation-of-approval-weight" title="Direct link to heading">​</a></h5><p>The approval weight itself is calculated every time a new voter is added/removed to a branch. The AW for a branch <em>B</em> is calculated as follows:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AW(B) = &#x27;active cMana of voters(B)&#x27; / &#x27;total active cMana&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="markers">Markers<a class="hash-link" href="#markers" title="Direct link to heading">​</a></h4><p>It would be computationally expensive to track the AW for each message individually. Instead, we approximate the AW with the help of <a href="/goshimmer/protocol_specification/components/markers">markers</a>. Once a marker fulfills a GoF, the corresponding GoF value is propagated into its past cone until all  messages have an equal or higher GoF.</p><p>Recall that markers are not part of the core protocol. As such, this description is merely an optimization from an implementation standpoint.</p><p>Rather than keeping a list of voters for each marker and collecting voters for each marker (which would also be expensive), we keep a list of voters along with its approved marker index for each marker sequence. This approach provides a simple and fast look-up for marker voters making use of the Tangle structure as mapped by the markers.</p><p>For each marker sequence, we keep a map of voter to marker index, meaning a voter supports a marker index <code>i</code>. This implies that the voter supports all markers with index <code>&lt;= i</code>.</p><p>Take the figure below as an example:
<img loading="lazy" alt="MarkersApprovalWeight SequenceVoters" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu8AAAChCAYAAAB3TlFkAAAF0nRFWHRteGZpbGUAJTNDbXhmaWxlJTIwaG9zdCUzRCUyMmFwcC5kaWFncmFtcy5uZXQlMjIlMjBtb2RpZmllZCUzRCUyMjIwMjEtMDMtMjVUMDMlM0E1NiUzQTAyLjMwNVolMjIlMjBhZ2VudCUzRCUyMjUuMCUyMChYMTEpJTIyJTIwdmVyc2lvbiUzRCUyMjE0LjQuOSUyMiUyMGV0YWclM0QlMjJKbXFuQmpJZ0t2UzRWVnJJUDJDMSUyMiUyMHR5cGUlM0QlMjJnb29nbGUlMjIlM0UlM0NkaWFncmFtJTIwaWQlM0QlMjJvNGFmTk5nVWRnMEhFbUVWeUlveiUyMiUzRTVacE5qNXN3RUlaJTJGRGRmS1lEREpNVXQyMjB1bFNudG9lNlRCQ1ZZZEhEbk9KdW12cngzc0FEWjBXNVZBSWxaNzhJeSUyRm4zY01uZ2dQSnR2VFI1N3U4czhzdzlRTFFIYnk0TklMQWo4TUFrJTJGOWclMkJ4Y2V1SVlsSTROSjVsdVZEbGV5UyUyQnNuYWJaZ1dSNDMyZ29HS09DN0pyT0ZTc0t2QklOWDhvNU96YWJyUmx0enJwTE45aHh2SzVTNm5xJTJGa2t6a3BYY1d4SlglMkZFeWFiM016c28zbFpzMDFOWTcyVGZaNW03Rmh6d1djUEpwd3hVWmEycHdSVEJjOXdLZnU5ZE5SZUY4WnhJZjZtZ3hiaUxhVUh2VGU5TG5FMm04VkZ0bERNcEZXd1FqcWZzblNmWXpXQUw0MWNiS2t1eWpuNSUyQlpzMGdERyUyQkslMkJORFpNemxxVjY1UEJ2clJNUTNNNFlzMTNwSnElMkJxa0ROT25YQ2JPTEtIMjdNQlgyZ1YxWktSOGd6V01tY3ZIdjFLWDRZclpGc3VWeVNiSFN0ZElhNVhYSkRVJTJCam1rcXlGdHpFYWtPcjgxMXVPc01YeGlSRXdkQUh3V2toOUhud0RmbndJeFFia2QzcXN0b2p4TzhNMUFKd1JsSUZtcTdybHlYS0dtUEdPaEVqRUZmQ3hsSzVWRlVvWExNaWNDdnUlMkZTaXlWRSUyQkRab1JzeWFVSm93eWZ1a0hzWjlGT0piJTJCdmVEc0o2N1Z6RkVNVTNUViUyRlExemdVOWVWOHgzYUtvN2hCWXJvMlZOOHJCRjhoQjBxOXZnJTJCUWQ0b1FPdjViemROVHpmRHRrQjZVVU9QZmhnOUlMWmVQU1FReTk4TUhvaEdJOWU3TkNMSG94ZVpMOGpCcVEzYyUyQmloQjZPSFJueHJ6QjE2QzAlMkJKaWRLdFFrT0YycUx5QTBrVlhjd2ZYSlkycXZUVTBSUzZUWk9PcG9IYmRObTlBRXRXemc1RmRya3RnbHRJcTBRbDhtYSUyQm9HUlR5TG90eVRJMWRSJTJCYXg5RFNITGlhb3hiTlp6MW9ibEtkcHVnOXNsMm5hQVpBRzlza2h0R2xaczBLVWU5eCUyQmV2cE9FVVcyc0JGRzdTZ0RmcEE2OTh2V2libklFSkJpWUdkYWZYeERyQWpla2pzYnE0NUZleWhQeUoyTjJHYkN2WmdQaUoyTjlXYkN2YnJqdzlqWUhkenhLbGdIJTJGT042dWFXVDcxU1I5a3NSbUViZGJpSVF1amY5ckppUDBmbUE1SjE4ODY3SVR2d1kyUkk2bTYlMkJPaFhxMFhqUTNUUTMlMkJUJTJGbyUyRnc3WGtna0FoSkxrTnVHTWhpTnJ4cmhIc2xVNFIlMkJBbUVUd2taemV4WFBiTSUyQmQxTGhzWDU1UVVBMEJOWU8yZUhBNUoxYzhmQnlUYWV0RjJZcTNBTyUyQndwbk9CNTFOM1djQ25VN1l4JTJCU3VwczVUb1c2ZmRFZWtycWJPRTZGdW4wekdaSzZtemhPaGZwZ0wxTnBWdDhUbFI5OFZGOWx3ZWZmJTNDJTJGZGlhZ3JhbSUzRSUzQyUyRm14ZmlsZSUzRZGVzZMAACAASURBVHic7d1peJT12YbxtGARqEFxwVZQa1XWqqColaqotdbaSou0qK9Sd1CBSnErKCBFkUUDBDCAISgSAiSgQEIiS4CwZYHsgbAlAUJAREUQhCzX+4ESWUzIzDyTmblz/o7j/yFTAsRzOsdF8sxMkGroy8jx2hsyQHtDBuhQzHQpLU1KS9OhmOlu3f5l5Pia/tGoBfS1jb620dc2+tq2tmOQ4we21bjw3jEDpUmTHDuH5n7iza8LLqKvbfS1jb620de2tR2DpCDnDuPdvhoXPjT3E0cfPJSW5s2vCy6ir230tY2+ttHXNsY7XFXzwmlpPHhYRl/b6GsbfW2jr2mMd7jKZ+Od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" width="751" height="161" class="img_E7b_"></p><p>The purple circles represent markers of the same sequence, the numbers are marker indices.</p><p>Four nodes (A to D) issue statements with past markers of the purple sequence. Node A and D issue messages having past marker with index 6, thus node A and D are the voters of marker 6 and all markers before, which is 1 to 5. On the other hand, node B issues a message having past marker with index 3, which implies node B is a voter for marker 1 and 2 as well.</p><p>This is a fast look-up and avoids walking through a marker&#x27;s future cone when it comes to retrieving voters for approval weight calculation.</p><p>For example, to find all voter of marker 2, we iterate through the map and filter out those support marker with <code>index &gt;= 2</code>. In this case, all nodes are its voters. As for marker 5, it has voters node A and D, which fulfill the check: <code>index &gt;= 5</code>.</p><p>Here is another more complicated example with parent sequences:
<img loading="lazy" alt="MarkersApprovalWeight SequenceVoters" src="/assets/images/MarkersApprovalWeightSequenceVoters-c053f7e782e60aa052ccf7e8b0b3aabf.png" width="841" height="231" class="img_E7b_"></p><p>The voter will be propagated to the parent sequence.</p><p>Node A issues message A2 having past markers <code>[1,4], [3,4]</code>, which implies node A is a voter for marker <code>[1,1]</code> to <code>[1,4]</code>, <code>[2,1]</code> to <code>[2,3]</code>, and <code>[3,4]</code>  as well as the message with marker <code>[3,5]</code> itself.</p><h5 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="calculation-of-approval-weight-1">Calculation of Approval Weight<a class="hash-link" href="#calculation-of-approval-weight-1" title="Direct link to heading">​</a></h5><p>The approval weight itself is calculated every time a new voter is added to a marker. The AW for a marker <em>M</em> is calculated as follows:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">AW(M) = &#x27;active cMana of voters(M)&#x27; / &#x27;total active cMana&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="grades-of-finality-gof">Grades of Finality (GoF)<a class="hash-link" href="#grades-of-finality-gof" title="Direct link to heading">​</a></h3><p>The tracking of AW itself is objective as long as the Tangle converges on all nodes. However, delays, network splits and ongoing attacks might lead to differences in perception so that a finality can only be expressed probabilistically. The higher the AW, the less likely a decision is going to be reversed. To abstract and simplify this concept we introduce the GoF. Currently, they are simply a translation of AW thresholds to a GoF, but one can imagine other factors as well.</p><p><strong>Message / non-conflicting transaction</strong>
GoF | AW
-- | --
0 | &lt; 0.25
1 | &gt;= 0.25
2 | &gt;= 0.45
3 | &gt;= 0.67</p><p><strong>Branch / conflicting transaction</strong>
GoF | AW
-- | --
0 | &lt; 0.25
1 | &gt;= 0.25
2 | &gt;= 0.45
3 | &gt;= 0.67</p><p>These thresholds play a curcial role in the safety vs. liveness of the protocol, together with the exact workings of <a href="#Active-cMana">active cMana</a>. We are currently investigating them with in-depth simulations.</p><ul><li>The higher the AW threshold the more voters a branch or message will need to reach a certain GoF -&gt; more secure but higher confirmation time.</li><li>As a consequence of the above point, TangleTime will be tougher to advance; making the cMana window more likely to get stuck and confirmations to halt forever.</li></ul><p>An application needs to decide when to consider a message and (conflicting) transaction as <em>confirmed</em> based on its safety requirements. Conversely, a message or branch that does not gain enough AW stays pending forever (and is orphaned/removed on snapshotting time).</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="modular-conflict-selection-function">Modular Conflict Selection Function<a class="hash-link" href="#modular-conflict-selection-function" title="Direct link to heading">​</a></h2><p>The modular conflict selection function is an abstraction on how a node sets an initial opinion on conflicts. By decoupling the objective perception of AW and a node&#x27;s initial opinion, we gain flexibility and it becomes effortless to change the way we set initial opinions without modifying anything related to the AW.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pure-on-tangle-voting-otv">Pure On Tangle Voting (OTV)<a class="hash-link" href="#pure-on-tangle-voting-otv" title="Direct link to heading">​</a></h3><p>The idea of pure OTV is simple: set the initial opinion based on the currently heavier branch as perceived by AW. However, building a coherent overall opinion means that conflicting realities (possible outcomes of overlapping conflict sets) can not be liked at the same time, which makes finding the heaviest branch to like not as trivial as it may seem.</p><p>In the examples below, a snapshot at a certain time of a UTXO-DAG with its branches is shown. The gray boxes labelled with <code>O:X</code> represent an output and and arrow from an output to a transaction means that the transaction is consuming this output. An arrow from a transaction to an output creates this output. An output being consumed multiple times is a conflict and the transactions create a branch, respectively. The number assiged to a branch, e.g., <code>Branch A = 0.2</code>, defines the currently perceived Approval Weight of the branch. A branch highlighted in <strong>bold</strong> is the outcome of applying the pure OTV rules, i.e., the branches that are liked from the perspective of the node.</p><p><strong>Example 1</strong>
The example below shows how applying the heavier branch rule recursively results in the end result of <code>A</code>, <code>C</code>, <code>E</code>, and thus the aggregated branch <code>C+E</code> being liked. Looking at the individual branch weights this result might be surprising: branch <code>B</code> has a weight of <code>0.3</code> which is bigger than its conflict branch <code>A = 0.2</code>. However, <code>B</code> is also in conflict with <code>C</code> which has an even higher weight <code>0.4</code>. Thus, <code>C</code> is liked, <code>B</code> cannot be liked, and <code>A</code> suddenly can become liked again.</p><p><code>E = 0.35</code> is heavier than <code>D = 0.15</code> and is therefore liked. An (aggregated) branch can only be liked if all its parents are liked which is the case with <code>C+E</code>.</p><p><img loading="lazy" alt="OTV example 1" src="/assets/images/otv-example-1-533f80f1e3bacde9b770fa3d90fc78e7.png" width="1934" height="1146" class="img_E7b_"></p><p><strong>Example 2</strong>
This example is exactly the same as example 1, except that branch <code>C</code> has a weight of <code>0.25</code> instead of <code>0.4</code>. Now the end result is branches <code>B</code> and <code>E</code> liked. Branch <code>B</code> is heavier than branch <code>C</code> and <code>A</code> (winning in all its conflict sets) and becomes liked. Therefore, neither <code>A</code> nor <code>C</code> can be liked.</p><p>Again, <code>E = 0.35</code> is heavier than <code>D = 0.15</code> and is therefore liked. An (aggregated) branch can only be liked if all its parents are liked which is not the case with <code>C+E</code> in this example.</p><p><img loading="lazy" alt="OTV example 2" src="/assets/images/otv-example-2-2d0a8c87ecf581a22ea6a2a000e29001.png" width="1938" height="1154" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="metastability-otv-and-fpcs">Metastability: OTV and FPCS<a class="hash-link" href="#metastability-otv-and-fpcs" title="Direct link to heading">​</a></h3><p>Pure OTV is susceptible to metastability attacks: If a powerful attacker can keep any branch of a conflict set reaching a high enough approval weight, the attacker can prevent the network from tipping to a side and thus theoretically halt a decision on the given conflicts indefinitely. Only the decision on the targeted conflicts is affected but the rest of the consensus can continue working. By forcing a conflict to stay unresolved, an attacker can, at most, prevent a node from pruning resources related to the pending decision.</p><p>In order to prevent such attacks from happening we are planning to implement FPCS with OTV as a conflict selection function. A more detailed description can be found <a href="https://iota.cafe/t/on-tangle-voting-with-fpcs/1218" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="like-switch">Like Switch<a class="hash-link" href="#like-switch" title="Direct link to heading">​</a></h2><p>Without the like switch, messages vote for branches simply by attaching in their underlying conflict&#x27;s future cone. While this principle is simple, it has one major flaw: the part of the Tangle of the losing conflict is abandoned so that only the <em>valid</em> part remains. This might lead to mass orphanage of &quot;unlucky&quot; messages that happened to first vote for the losing branch. With the help of weak parents these messages might be <em>rescued</em> without a reattachment but the nature of weak parents makes it necessary so that every message needs to be picked up individually. Next to the fact that keeping such a weak tip pool is computationally expensive, it also open up orphanage attack scenarios by keeping conflicts undecided (metastability attack turns into orphanage attack).</p><p>The like switch is a special type of parent reference that enables  keeping everything in the Tangle, even conflicting transactions that are not included into the valid ledger state by means of consensus. Therefore, it prevents mass orphanage and enables a decoupling of <strong>voting on conflicts (UTXO ledger)</strong> and <strong>finality of messages / voting on messages (Tangle)</strong>. It makes the overall protocol (and its implementation) not only more efficient but also easier to reason about and allows for lazy evaluation of a node&#x27;s opinion, namely only when a node wants to issue a message (read as: <em>cast a vote</em>).</p><p>From a high-level perspective, the like switch can be seen as a set of rules that influence the way a message inherits its branches. Using only strong parents, a message inherits all its parents&#x27; branches. A like parent retains all the properties of the strong parent (i.e., inherit the branch of said parent) but additionally it means to exclude all branches that are conflicting with the liked branch.
Through this mechanism, it becomes possible to attach a message anywhere in the Tangle but still only vote for the branches that are liked. Thus, decoupling of message AW and branch AW.</p><p><strong>Examples</strong>
To make this more clear, let&#x27;s consider the following examples. The branches <code>A</code> and <code>B</code>, as well as <code>C</code> and <code>D</code> form an independent conflict set, respectively. The <code>Branch Weights</code> are the weights as perceived by the node that currently wants to create a message.</p><p><strong>Message creation</strong>
A node performs random tip selection (e.g. URTS) and in this example selects messages <code>5</code> and <code>11</code> as strong parents. Now the node needs to determine whether it currently <em>likes</em> all the branches of the selected messages (<code>red, yellow, green</code>) in order to apply the like switch (if necessary) and vote for its liked branches.</p><p><img loading="lazy" alt="Like switch: message creation undecided" src="/assets/images/like-switch-message-creation-1-eed3f608904275dc459dbd2ade9550f7.png" width="2056" height="684" class="img_E7b_"></p><p>When performing the conflict selection function with pure OTV it will yield the result:</p><ul><li><code>red</code> is disliked, instead like <code>purple</code></li><li><code>green</code> is disliked, instead like <code>yellow</code></li></ul><p>Therefore, the message needs to set two like references to the messages that introduced the branch (first attachment of the transaction). The final result is the following:</p><ul><li>branches <code>purple</code> and <code>yellow</code> are supported</li><li>message <code>5</code> (and its entire past cone, <code>3</code>, <code>2</code>, <code>1</code>) is supported</li><li>message <code>11</code> (and its entire past cone, <code>6</code>, <code>4</code>, <code>2</code>, <code>1</code>) is supported</li><li>message <code>6</code> (and its entire past cone, <code>4</code>, <code>2</code>, <code>1</code>)</li><li>message <code>7</code> (and its entire past cone, <code>1</code>)</li></ul><p><img loading="lazy" alt="Like switch: message creation" src="/assets/images/like-switch-message-creation-2-33595a0417e40c7e9d81a1ff43b831b6.png" width="2056" height="684" class="img_E7b_"></p><p><strong>Message booking</strong>
On the flip side of message creation (casting a vote) is applying a vote when booking a message, where the process is essentiall just reversed. Assuming a node receives message <code>17</code>. First, it determines the branches of the strong parents (<code>red</code>, <code>yellow</code>, <code>purple</code>) and like parents (<code>red</code>). Now, it removes all branches that are conflicting with the like parents&#x27; branches (i.e., <code>purple</code>) and is left with the branches <code>red</code> and <code>yellow</code> (and adds the like branches to it, which in this case is without effect). If the resulting branch is <code>invalid</code>, (e.g., because it combines conflicting branches) then the message itself is considered invalid because the issuer did not follow the protocol.</p><p>In this example the final result is the following (message <code>17</code> supports):</p><ul><li>branches <code>red</code> and <code>yellow</code></li><li>message <code>16</code> and its entire past cone</li><li>message <code>11</code> and its entire past cone</li><li>message <code>4</code> and its entire past cone</li></ul><p><img loading="lazy" alt="Like switch: message booking" src="/assets/images/like-switch-message-booking-d4975c4d53da78151eaa5b7784d97d74.png" width="2056" height="682" class="img_E7b_"></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="active-cmana">Active cMana<a class="hash-link" href="#active-cmana" title="Direct link to heading">​</a></h2><p>The consensus mechanism weighs votes on branches (messages in future cone with like switch) or message inclusion (all messages in future cone) by the limited resource cMana, which is thus our Sybil-protection mechanism. cMana can be pledged to any nodeID, including offline or non-existing nodes, when transferring funds (in the proportion of the funds) and is instantly available (current implementation without EMA). Funds might get lost/locked over time, and, therefore, the total accessible cMana declines as well. <strong>Consequently, a fixed cMana threshold cannot be used to determine a voting outcome.</strong></p><p>Finalization of voting outcomes should happen once a conflict is <em>sufficiently</em> decided and/or a message is <em>sufficiently</em> deep in the Tangle. However, measuring AW in terms of cMana alone does not yield enough information. Therefore, a degree/grade of finalization and of voting outcome in relation to <em>something</em>, e.g., <strong>recently active nodes</strong>, is preferred. This measure should have the following properties:</p><ul><li>security/resilience against various attacks</li><li>lose influence (shortly) after losing access to funds</li><li>no possibility of long-range attacks</li><li>no too quick fluctuations</li><li>real incentives</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="current-implementation">Current Implementation<a class="hash-link" href="#current-implementation" title="Direct link to heading">​</a></h3><p>Active cMana in GoShimmer basically combines two components in an active cMana WeightProvider: the TangleTime and the current state of cMana. A node is considered to be active if it has issued any message in the last <code>activeTimeThreshold=30min</code> with respect to the TangleTime. The total active consensus mana is, therefore, the sum of all the consensus mana of each active node.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tangletime">TangleTime<a class="hash-link" href="#tangletime" title="Direct link to heading">​</a></h4><p>The TangleTime is the issuing time of the last confirmed message. It cannot be attacked without controlling enough mana to accept incorrect timestamps, making it a reliable, attack-resistant quantity.</p><p><img loading="lazy" alt="Tangle Time" src="/assets/images/tangle_time-99909b3022bc3113b4598b3035f951d8.jpg" width="951" height="1587" class="img_E7b_"></p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cmana">cMana<a class="hash-link" href="#cmana" title="Direct link to heading">​</a></h4><p>The current state of cMana is simply the current cMana vector, at the time the active cMana is requested.</p><h4 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="putting-it-together">Putting it together<a class="hash-link" href="#putting-it-together" title="Direct link to heading">​</a></h4><p>Every node keeps track of a list of active nodes locally. Whenever a node issues a message it is added to the list of active nodes (nodeID -&gt; issuing time of latest message). When the active cMana is requested all relevant node weights are returned. Relevant here means the following:</p><ul><li>the node has more than <code>minimumManaThreshold=0</code> cMana to prevent bloating attacks with too little cMana</li><li>there is a message that fulfills the condition <code>issuing time &lt;= TangleTime &amp;&amp; TangleTime - issuing time &lt;= activeTimeThreshold</code> where <code>activeTimeThreshold=30min</code> (see the following example, messages <code>1</code> and <code>3</code> are not within the window)</li></ul><p><img loading="lazy" alt="Active cMana window" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAX0AAACSCAYAAACpHBqyAAAGGHRFWHRteGZpbGUAJTNDbXhmaWxlJTIwaG9zdCUzRCUyMmFwcC5kaWFncmFtcy5uZXQlMjIlMjBtb2RpZmllZCUzRCUyMjIwMjEtMTAtMzBUMDclM0E0OSUzQTU2LjI1OFolMjIlMjBhZ2VudCUzRCUyMjUuMCUyMChNYWNpbnRvc2gpJTIyJTIwZXRhZyUzRCUyMm52d2ZRZUlhVHo5V2h3RU02V0o5JTIyJTIwdmVyc2lvbiUzRCUyMjE1LjYuMiUyMiUyMHR5cGUlM0QlMjJnb29nbGUlMjIlM0UlM0NkaWFncmFtJTIwaWQlM0QlMjJHM1lZcnJ2Y2JvclNwTGFUYU5mZiUyMiUyMG5hbWUlM0QlMjJQYWdlLTElMjIlM0U1VmxkazVvd0ZQMDFQTFlEQkVRZlY5MTJYenF6TSUyQnUwOWpGQ2hNeEd3c1Q0dGIlMkIlMkJOeEMlMkJqSzQ0MWVwdWZaRWNraHM0NSUyQmJjUkMwMFdteSUyRkM1d2xQM2hFbU9YYTBkWkNZOHQxSGMlMkZ0d1pkQ2RnVVM5SUlDaUFXTmRLY2FlS0Z2UklPMlJsYzBJc3RXUjhrNWt6UnJneUZQVXhMS0ZvYUY0SnQydHpsbjdWa3pIQk1EZUFreE05RmZOSkpKZ2ZaOXU4YWZDSTJUY21iSDFuY1d1T3lzZ1dXQ0k3NXBRT2pSUWlQQnVTeXVGdHNSWVlxOGtwZGkzTGNqZDZzSEV5U1ZYUWJZRDIlMkIlMkZwdXMlMkJEbWVUWUpqZ24zdzYzWDF4aXlocnpGYjZoZlhEeWwzSkFFbWpCMFVrdEVLR2wwc2FXbWlZeUFVRHdJRkx3VmRwUk5Ra05yU1dVdkRYaWlvdlI3Q1FaWVNVcHhCMldFeENJb1A3JTJCbVUwdE9RckVaSjMzaUNvcUlRY0pIeEJwTmpCdUUwdFZxbFYwdENweEFSaFdOSjElMkJ6R3d6cG00Q2xmTjhNd3BQS0JyNiUyRndlNkRBNnVWRmd0eU1VVDY4SE5iWFppJTJCUFpKd0lCaHpHUlJpQzRhTHgxRGVYU241RUc2SFFhUVBwbTZqSmNDYlliQ2h5JTJCRXVCeXVFbW9KQzhaempYYWdBY2NTdzdWbWpPYVBWVjNKRERQVTJnT3pNUnhxeVJaRXlISjl2MDBNZVV2QiUyRmglMkJtMWVrMjQzMGNBJTJCa2glMkJQYngxT2hSZjY1VEhzRzB6aFVDVGloQ3pKSkJGa215cUgyeVFjR1pKdllncTRSWjF6VXkycE9HZHVETUtPeDRqZ0V4Z2pnUThVbkJYOTcwRGNXTklyVU5BZVZiSyUyRnRPVSUyQmxkbWluZHlHQlVGc2dyMVNqSVZEdmdFRG9XdnI0aGo0VG5NWXMxJTJCZiUyRmthVXF2JTJCVzZzYzExODA5bDZaOVZwelRKWnhTcDdnV3BjT0o3TFVqZXBRclNxVUJYTGtpRFMlMkI5TDloZUpXVzdJbHNxcDZ2M1YxNjNmT3BLNkhtOTFvTHl4MDQwTDdtUDhXNmFOMjc5UTNweE13Q3ZuamROaFF4dERabVJIVFZJZkpQQ3M3Rjd0OUR1YjV6NlpIV3ZhUGxVWE04JTJGZ05DZU01bzVwR21ORUJiQlI3Tk1nQ1JUZVhHUVpFVkFZOHhJMm5zR2VjQWJPJTJCMXhqdzB3Sm5iJTJCUFA3VDhNU0FRUTAwMnFzNXJoMVpuczJKYUxvcjZ0aDBnM2ElMkJCeiUyRk9QVVhiaHptaGt3NmRyTVh3bmxZNnJ2TGV6TkRWMkRtanNYVXZqY3JLR3lPZ3o3VmZPa3VoV3V4U253em5xMnU3am9EdHpIOGM4OG53dyUyQiUyQmxGJTJGYURubldNJTJGM25ndyUyQkZ2N1FSJTJGS2ZzeHprNm55cDdPZkl4TGR6SDQ2RlBwcjI4JTJGZHVVJTJCSGslMkJOOXU4OXROajlIVHJGMzZqN21jZEV4VlA1MDduUDZoNFlMdVE4MDY3OHBpcE5hJTJGV2NQZXZ3RCUzQyUyRmRpYWdyYW0lM0UlM0MlMkZteGZpbGUlM0U0JtcqAAAWCUlEQVR4nO3d309Tef7H8fc/cOJe9arJEC56wUVnQtKEpDEQEkIIS7AxJYSMkUhilLBumI3iEp0Wf8zF6uhEXV13x+n4I7PGGZXdEA3BlfqDrzMKqDA6ZsmoswK67GgdBORnX98L5nzooUVLSzmt5/VIPslQ2p6PwznPHs45LQIiIrIMMXsCRES0fBh9IiILYfSJiCyE0ScishBGn4jIQhh9IiILYfSJiCyE0ae0l5ubCxF546iurl6WuVy9ehUi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" width="381" height="146" class="img_E7b_"></p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h3><p>When syncing (<code>TT=t0</code>) and booking a message from time <code>t1</code>, active cMana is considered from <code>t0-activeTimeThreshold</code>. Once this message gets confirmed, the TangleTime advances to <code>TT=t1</code>. For the next message at <code>t2</code>, <code>TT=t1-activeTimeThreshold</code> will be considered. Using active cMana in this way, we basically get a sliding window of how the Tangle emerged and <em>replay</em> it from the past to the present.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="pros">Pros<a class="hash-link" href="#pros" title="Direct link to heading">​</a></h3><ul><li>replaying the Tangle as it emerged</li><li>always use cMana from the current perspective</li><li>relatively simple concept</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="cons">Cons<a class="hash-link" href="#cons" title="Direct link to heading">​</a></h3><ul><li>active cMana does not yield sufficient information (e.g. when eclipsed), it might look like something is 100% confirmed even though only 2% of the total cMana are considered active.</li><li>active cMana might change quickly nodes with high mana suddenly become active</li><li>if nodes are only able to issue messages when &quot;in sync&quot; and no message gets confirmed within that time, nobody might be able to issue messages anymore</li><li>if a majority/all active cMana nodes go offline <em>within the active cMana window</em>, consensus will halt forever because the TangleTime can never advance unless a majority of these nodes move the TangleTime forward</li></ul><p>This reflects the current implementation and we are currently investigating active cMana with in-depth simulations to improve the mechanism.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/iotaledger/goshimmer/edit/develop/documentation/docs/protocol_specification/components/consensus_mechanism.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/goshimmer/protocol_specification/components/congestion_control"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">congestion_control</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/goshimmer/protocol_specification/components/ledgerstate"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ledgerstate</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#approval-weight-aw" class="table-of-contents__link toc-highlight">Approval Weight (AW)</a><ul><li><a href="#detailed-design" class="table-of-contents__link toc-highlight">Detailed Design</a></li><li><a href="#grades-of-finality-gof" class="table-of-contents__link toc-highlight">Grades of Finality (GoF)</a></li></ul></li><li><a href="#modular-conflict-selection-function" class="table-of-contents__link toc-highlight">Modular Conflict Selection Function</a><ul><li><a href="#pure-on-tangle-voting-otv" class="table-of-contents__link toc-highlight">Pure On Tangle Voting (OTV)</a></li><li><a href="#metastability-otv-and-fpcs" class="table-of-contents__link toc-highlight">Metastability: OTV and FPCS</a></li></ul></li><li><a href="#like-switch" class="table-of-contents__link toc-highlight">Like Switch</a></li><li><a href="#active-cmana" class="table-of-contents__link toc-highlight">Active cMana</a><ul><li><a href="#current-implementation" class="table-of-contents__link toc-highlight">Current Implementation</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#pros" class="table-of-contents__link toc-highlight">Pros</a></li><li><a href="#cons" class="table-of-contents__link toc-highlight">Cons</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer padding--none"><div class="container"><div class="row footer__links padding-vert--xl"><div class="col footer__col"><h4 class="footer__title">LEARN</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/learn/about-iota/an-introduction-to-iota">About IOTA</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/iota-token/buying-iota">IOTA Token</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/wallets/what-is-a-wallet">Wallets</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/networks/iota-1.5-chrysalis">Networks</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/glossary">Glossary</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/research/research-outline">Research</a></li><li class="footer__item"><a class="footer__link-item" href="/learn/future/future-of-iota">Future of IOTA</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">PARTICIPATE</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/participate/support-the-network/about-nodes">Support the network</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/the-community/discord">The Community</a></li><li class="footer__item"><a href="https://www.iota.org/solutions/partnerships" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partnerships</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/funding/edf-funding">Funding</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/use-cases/industry-applications">Use Cases</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/frameworks/introduction">Frameworks</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">BUILD</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/build/welcome">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/build/fundamentals/cryptography">Fundamentals</a></li><li class="footer__item"><a class="footer__link-item" href="/build/exchange-integration/exchange-integration-guide">Exchange Integration</a></li><li class="footer__item"><a class="footer__link-item" href="/build/tutorials/twitch">Tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">WIKI</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/team">Team</a></li><li class="footer__item"><a href="https://github.com/iota-community/iota-wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://github.com/jlvandenhout/docusaurus-plugin-docs-editor" target="_blank" rel="noopener noreferrer" class="footer__link-item">Editor Github</a></li><li class="footer__item"><a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/participate/contribute-to-wiki/welcome">Contribute</a></li><li class="footer__item"><a href="https://www.iota.org/impressum" target="_blank" rel="noopener noreferrer" class="footer__link-item">Impressum</a></li><li class="footer__item"><a href="https://www.iota.org/privacy-policy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li></ul></div></div><div class="footer__bottom padding-bottom--xl"><div class="footer__copyright">© 2022 TNTT Wiki. Built with Docusaurus.</div></div></div><div class="social"><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:var(--ifm-color-gray-900)" href="https://www.youtube.com/c/iotafoundation"><div class="social__font social__icon"></div><div class="social__title">Youtube</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#2C3850" href="https://www.github.com/iotaledger/"><div class="social__font social__icon"></div><div class="social__title">GitHub</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#4B576F" href="https://discord.iota.org/"><div class="social__font social__icon"></div><div class="social__title">Discord</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#6A768E" href="https://www.twitter.com/iota/"><div class="social__font social__icon"></div><div class="social__title">Twitter</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#7D89A1" href="https://www.reddit.com/r/iota/"><div class="social__font social__icon"></div><div class="social__title">Reddit</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#8995AD" href="https://www.linkedin.com/company/iotafoundation/"><div class="social__font social__icon"></div><div class="social__title">LinkedIn</div></a><a class="social__link padding-horiz--sm padding-vert--md" style="background-color:#99A5BD" href="https://www.instagram.com/iotafoundation/"><div class="social__font social__icon"></div><div class="social__title">Instagram</div></a></div></footer></div>
<script src="/assets/js/runtime~main.8139a13d.js"></script>
<script src="/assets/js/main.a258838c.js"></script>
</body>
</html>